<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:tei="http://www.tei-c.org/ns/1.0" xmlns:xf="http://www.w3.org/2002/xforms" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:sc="http://www.ascc.net/xml/schematron" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:local="http://syriaca.org/ns">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Edit MSS TEI records</title>
      <meta name="author" content="Winona Salesky" />
      <meta name="description" content="Example of TEI XForms generated from ODD. Run as an eXist-db application. Resulting TEI can be saved to eXist-db, downloaded to local filesystem, or saved to a GitHub repository" />
      <link rel="stylesheet" type="text/css" href="resources/bootstrap/css/bootstrap.min.css" />
      <link rel="stylesheet" type="text/css" href="resources/css/xforms.css" />
      <link href="resources/jquery-ui/jquery-ui.min.css" rel="stylesheet" /><script type="text/javascript" src="resources/js/jquery.min.js"></script><script type="text/javascript" src="resources/bootstrap/js/bootstrap.min.js"></script><xf:model id="m-mss">
         <xf:instance id="i-rec">
            <data></data>
         </xf:instance>
         <xf:instance id="i-upload">
            <attachment xsi:type="xsd:anyURI"></attachment>
         </xf:instance>
         <xf:instance id="i-search">
            <data></data>
         </xf:instance>
         <xf:instance id="i-search-results">
            <data></data>
         </xf:instance>
         <xf:instance id="i-selected">
            <data></data>
         </xf:instance>
         <xf:instance id="i-selectTemplate">
            <data>
               <template name="Generic MSS Template" src="/forms/templates/full-mss-template.xml"></template>
               <template name="Generic Persons Template" src="/forms/templates/persons-template.xml"></template>
               <template name="Generic Template" src="/forms/templates/template.xml"></template>
            </data>
         </xf:instance>
         <xf:instance id="i-subforms">
            <data>
               <subform formName="additions"></subform>
               <subform formName="msPart"></subform>
               <subform formName="mssSupport"></subform>
               <subform formName="layoutDesc"></subform>
               <subform formName="history"></subform>
               <subform formName="handDesc"></subform>
            </data>
         </xf:instance>
         <xf:submission id="s-load-template" method="post" ref="instance('i-selected')" replace="instance" instance="i-rec" serialization="none" mode="synchronous">
            <xf:resource value="concat('services/get-rec.xql?template=true&amp;path=',instance('i-selected'))"></xf:resource>
            <xf:message level="modeless" ev:event="xforms-submit-done"> Data Loaded! </xf:message>
            <xf:message level="modeless" ev:event="xforms-submit-error"> Submit error. </xf:message>
         </xf:submission>
         <xf:submission id="s-search-saved" method="post" ref="instance('i-search')" replace="instance" instance="i-search-results" serialization="none" mode="synchronous" action="services/get-rec.xql?search=true">
            <xf:message level="modeless" ev:event="xforms-submit-done"> Data Loaded! </xf:message>
            <xf:message level="modeless" ev:event="xforms-submit-error"> Submit error. </xf:message>
         </xf:submission>
         <xf:submission id="s-browse-saved" method="post" ref="instance('i-search')" replace="instance" instance="i-search-results" serialization="none" mode="synchronous" action="services/get-rec.xql?search=true&amp;view=all">
            <xf:message level="modeless" ev:event="xforms-submit-error"> Submit error. </xf:message>
         </xf:submission>
      </xf:model>
   </head>
   <body>
      <div class="section xforms">
         <h1>Edit MSS TEI records</h1>
         <p class="hint warning">Example of TEI XForms generated from ODD. Run as an eXist-db application. Resulting
            TEI can be saved to eXist-db, downloaded to local filesystem, or saved to a GitHub
            repository
         </p>
         <div class="row tabbable">
            <ul class="nav nav-pills nav-stacked col-md-3">
               <li>
                  <xf:trigger appearance="minimal" class="btn btn-default nav-pill btn-block">
                     <xf:label>Main Page  </xf:label>
                     <xf:action ev:event="DOMActivate">
                        <xf:toggle case="view-main-entry"></xf:toggle>
                     </xf:action>
                  </xf:trigger>
               </li>
               <li>
                  <xf:trigger appearance="minimal" ref="instance('i-subforms')//*:subform[@formName = 'additions']" class="btn btn-default nav-pill btn-block">
                     <xf:label>additions  </xf:label>
                     <xf:action ev:event="DOMActivate">
                        <xf:toggle case="view-data-entry"></xf:toggle>
                        <xf:load if="@selected != 'true'" show="embed" targetid="subform" resource="form.xq?form=forms/additions.xhtml"></xf:load>
                        <xf:unload if="@selected = 'true'" targetid="subform"></xf:unload>
                        <xf:setvalue ref="@selected" value=". != 'true'"></xf:setvalue>
                     </xf:action>
                  </xf:trigger>
               </li>
               <li>
                  <xf:trigger appearance="minimal" ref="instance('i-subforms')//*:subform[@formName = 'msPart']" class="btn btn-default nav-pill btn-block">
                     <xf:label>msPart  </xf:label>
                     <xf:action ev:event="DOMActivate">
                        <xf:toggle case="view-data-entry"></xf:toggle>
                        <xf:load if="@selected != 'true'" show="embed" targetid="subform" resource="form.xq?form=forms/msPart.xhtml"></xf:load>
                        <xf:unload if="@selected = 'true'" targetid="subform"></xf:unload>
                        <xf:setvalue ref="@selected" value=". != 'true'"></xf:setvalue>
                     </xf:action>
                  </xf:trigger>
               </li>
               <li>
                  <xf:trigger appearance="minimal" ref="instance('i-subforms')//*:subform[@formName = 'mssSupport']" class="btn btn-default nav-pill btn-block">
                     <xf:label>mssSupport  </xf:label>
                     <xf:action ev:event="DOMActivate">
                        <xf:toggle case="view-data-entry"></xf:toggle>
                        <xf:load if="@selected != 'true'" show="embed" targetid="subform" resource="form.xq?form=forms/mssSupport.xhtml"></xf:load>
                        <xf:unload if="@selected = 'true'" targetid="subform"></xf:unload>
                        <xf:setvalue ref="@selected" value=". != 'true'"></xf:setvalue>
                     </xf:action>
                  </xf:trigger>
               </li>
               <li>
                  <xf:trigger appearance="minimal" ref="instance('i-subforms')//*:subform[@formName = 'layoutDesc']" class="btn btn-default nav-pill btn-block">
                     <xf:label>layoutDesc  </xf:label>
                     <xf:action ev:event="DOMActivate">
                        <xf:toggle case="view-data-entry"></xf:toggle>
                        <xf:load if="@selected != 'true'" show="embed" targetid="subform" resource="form.xq?form=forms/layoutDesc.xhtml"></xf:load>
                        <xf:unload if="@selected = 'true'" targetid="subform"></xf:unload>
                        <xf:setvalue ref="@selected" value=". != 'true'"></xf:setvalue>
                     </xf:action>
                  </xf:trigger>
               </li>
               <li>
                  <xf:trigger appearance="minimal" ref="instance('i-subforms')//*:subform[@formName = 'history']" class="btn btn-default nav-pill btn-block">
                     <xf:label>history  </xf:label>
                     <xf:action ev:event="DOMActivate">
                        <xf:toggle case="view-data-entry"></xf:toggle>
                        <xf:load if="@selected != 'true'" show="embed" targetid="subform" resource="form.xq?form=forms/history.xhtml"></xf:load>
                        <xf:unload if="@selected = 'true'" targetid="subform"></xf:unload>
                        <xf:setvalue ref="@selected" value=". != 'true'"></xf:setvalue>
                     </xf:action>
                  </xf:trigger>
               </li>
               <li>
                  <xf:trigger appearance="minimal" ref="instance('i-subforms')//*:subform[@formName = 'handDesc']" class="btn btn-default nav-pill btn-block">
                     <xf:label>handDesc  </xf:label>
                     <xf:action ev:event="DOMActivate">
                        <xf:toggle case="view-data-entry"></xf:toggle>
                        <xf:load if="@selected != 'true'" show="embed" targetid="subform" resource="form.xq?form=forms/handDesc.xhtml"></xf:load>
                        <xf:unload if="@selected = 'true'" targetid="subform"></xf:unload>
                        <xf:setvalue ref="@selected" value=". != 'true'"></xf:setvalue>
                     </xf:action>
                  </xf:trigger>
               </li>
            </ul>
            <div class="tab-content col-md-9">
               <xf:switch id="edit" class="tab-panel">
                  <xf:case id="view-main-entry" selected="true()">
                     <h2>Find your data</h2>
                     <div class="fileLoading">
                        <xf:select1 xmlns="http://www.w3.org/2002/xforms" ref="instance('i-selected')">
                           <xf:label>Search saved TEI records</xf:label>
                           <xf:itemset ref="instance('i-selectTemplate')//*:template">
                              <xf:label ref="@name"></xf:label>
                              <xf:value ref="@src"></xf:value>
                           </xf:itemset>
                        </xf:select1>
                        <xf:submit class="btn btn-default" submission="s-load-template" appearance="minimal">
                           <xf:label> Load selected record </xf:label>
                        </xf:submit>
                     </div>
                     <div class="fileLoading">
                        <xf:input ref="instance('i-search')" incremental="true">
                           <xf:label>Select a saved TEI XML record: </xf:label>
                        </xf:input>
                        <xf:submit class="btn btn-default" submission="s-search-saved" appearance="minimal">
                           <xf:label> Search </xf:label>
                        </xf:submit>
                        <xf:submit class="btn btn-default" submission="s-browse-saved" appearance="minimal">
                           <xf:label> Browse </xf:label>
                        </xf:submit>
                     </div>
                     <div class="fileLoading">
                        <xf:select1 xmlns="http://www.w3.org/2002/xforms" ref="instance('i-selected')">
                           <xf:label>Select a TEI XML record to edit</xf:label>
                           <xf:itemset ref="instance('i-search-results')//*:record">
                              <xf:label ref="@name"></xf:label>
                              <xf:value ref="@src"></xf:value>
                           </xf:itemset>
                        </xf:select1>
                        <xf:submit class="btn btn-default" submission="s-load-search" appearance="minimal">
                           <xf:label> Load selected record </xf:label>
                        </xf:submit>
                     </div>
                     <h3>Preview XML</h3>
                     <xf:group>
                        <xf:output value="serialize(instance('i-rec'))"></xf:output>
                     </xf:group>
                  </xf:case>
                  <xf:case id="view-data-entry">
                     <xf:group id="subform"></xf:group>
                  </xf:case>
               </xf:switch>
            </div>
         </div>
      </div>
   </body>
</html>